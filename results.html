<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>검사 결과</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 { text-align: center; color: #2c3e50; }
    #result-box {
      max-width: 900px;
      margin: 20px auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 30px;
    }
    #result h2 { text-align: center; margin-top: 0; color: #4a90e2; }
    #nickname { text-align: center; font-size: 1.3rem; font-weight: bold; color: #2c3e50; margin-bottom: 5px; }
    #catchphrase { text-align: center; font-style: italic; margin-bottom: 20px; color: #666; }
    #description { text-align: center; margin-bottom: 30px; color: #444; }
    a, button {
      display: block; text-align: center; margin: 20px auto 0;
      text-decoration: none; color: #fff; background: #4a90e2;
      padding: 10px 20px; border-radius: 8px; border: none; font-size: 16px; cursor: pointer;
    }
    a:hover, button:hover { background: #357abd; }
    #saveBtn { background: #50c878; }
    #saveBtn:hover { background: #3da96a; }

    .axis-wrapper { display: flex; align-items: center; margin: 24px 0; flex-wrap: wrap; }
    .category { width: 140px; font-weight: bold; font-size: 14px; text-align: right; padding-right: 10px; }
    .axis { display: flex; align-items: center; flex: 1; min-width: 250px; }
    .left, .right { width: 80px; text-align: center; font-weight: bold; font-size: 13px; }
    .bar {
      position: relative;
      flex: 1;
      min-width: 100px; /* 모바일에서도 막대 표시 */
      height: 10px;
      background: #ddd;
      margin: 0 10px;
      border-radius: 5px;
    }
    .indicator {
      position: absolute;
      top: -5px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      transform: translateX(-50%);
    }
    .indicator::after {
      content: attr(data-percent) '%';
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: #333;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <h1>검사 결과</h1>
  <div id="result-box">
    <div id="result"></div>
    <div id="sliders"></div>
  </div>
  <button id="saveBtn">결과 이미지로 저장</button>
  <a href="index.html">다시 검사하기</a>

  <script>
    const typeData = [
      { type: "R-E-D-O", nickname: "함께하는 마음 정원사", catchphrase: "사랑으로 계획하며 나누자", description: "체계적인 계획으로 공동체와 하나님의 사랑을 깊이 나누는 따뜻한 리더" },
      { type: "R-E-D-F", nickname: "자유로운 사랑 전도사", catchphrase: "마음이 이끄는 대로 사랑하자", description: "즉흥적이고 유연하게 공동체 안에서 하나님의 사랑을 전하는 자유로운 영혼" },
      { type: "R-E-P-O", nickname: "체계적인 감동 건축가", catchphrase: "질서로 감동을 설계하자", description: "계획적으로 공동체의 영적 체험을 조직하며 하나님의 원칙을 실천하는 기획자" },
      { type: "R-E-P-F", nickname: "순간의 영감 나눔이", catchphrase: "지금 이 순간, 진리를 느끼자", description: "유연하게 공동체와 함께 하나님의 진리를 체험하며 순간의 영감을 나누는 활동가" },
      { type: "R-W-D-O", nickname: "말씀으로 세우는 목자", catchphrase: "체계적 말씀으로 사랑 나누기", description: "계획적으로 말씀을 연구하고 공동체에 하나님의 친밀함을 체계적으로 전하는 교사" },
      { type: "R-W-D-F", nickname: "유연한 말씀 동행자", catchphrase: "말씀과 함께 자유롭게 걷기", description: "자유롭게 말씀을 나누며 공동체와 함께 하나님과의 친밀한 관계를 추구하는 동반자" },
      { type: "R-W-P-O", nickname: "원칙 세우는 말씀 디자이너", catchphrase: "말씀과 질서로 세우기", description: "말씀과 원칙을 기반으로 공동체를 계획적으로 세워 나가는 사람" },
      { type: "R-W-P-F", nickname: "자유로운 말씀 탐험가", catchphrase: "말씀과 함께 자유를", description: "자유로운 분위기 속에서 말씀과 원칙을 함께 나누는 탐험가" },
      { type: "S-E-D-O", nickname: "고요한 사랑 수도자", catchphrase: "묵상 속에서 사랑을 계획하기", description: "체계적인 개인 묵상을 통해 하나님과의 친밀한 관계를 깊이 체험하는 영성가" },
      { type: "S-E-D-F", nickname: "자유로운 사랑 탐색자", catchphrase: "마음이 흐르는 대로 묵상", description: "자유롭게 개인 묵상을 즐기며 하나님과의 친밀한 동행을 추구하는 사람" },
      { type: "S-E-P-O", nickname: "원칙 중심 영성 설계자", catchphrase: "묵상으로 세우는 삶", description: "개인 묵상과 체험 속에서 하나님의 원칙을 질서 있게 세우는 사람" },
      { type: "S-E-P-F", nickname: "자유로운 진리 탐험가", catchphrase: "혼자서 진리를 자유롭게 탐험", description: "유연한 개인 영성으로 하나님의 원칙을 체험적으로 발견해가는 영적 모험가" },
      { type: "S-W-D-O", nickname: "말씀 연구하는 친구", catchphrase: "체계적 말씀으로 친밀함 추구", description: "계획적인 개인 말씀 연구를 통해 하나님과의 깊은 우정을 쌓아가는 학자" },
      { type: "S-W-D-F", nickname: "말씀과 동행하는 순례자", catchphrase: "자유로운 말씀의 여정", description: "자유로운 방식으로 말씀을 묵상하며 하나님과 함께 동행하는 순례자" },
      { type: "S-W-P-O", nickname: "말씀 원칙 설계자", catchphrase: "말씀으로 질서를 세우다", description: "말씀 중심으로 삶을 계획하고 하나님의 원칙을 따라가는 설계자" },
      { type: "S-W-P-F", nickname: "진리 속 자유 순례자", catchphrase: "말씀 안에서 자유롭게 순례", description: "유연한 개인 말씀 묵상으로 하나님의 진리 원칙을 자유롭게 탐구하는 순례자" }
    ];

    const params = new URLSearchParams(window.location.search);
    const scoresParam = params.get("scores");

    if (!scoresParam) {
      document.getElementById('result').innerHTML = "<p>결과 데이터를 찾을 수 없습니다.</p>";
    } else {
      const scores = scoresParam.split(",").map(Number);

      const types = [];
      types[0] = scores[0] >= 13 ? "R형(교제형)" : "S형(묵상형)";
      types[1] = scores[1] >= 13 ? "E형(체험형)" : "W형(말씀형)";
      types[2] = scores[2] >= 13 ? "D형(관계중심형)" : "P형(원칙중심형)";
      types[3] = scores[3] >= 13 ? "O형(정돈형)" : "F형(유연형)";

      const descriptions = {
        "R": "사람들과 함께하는 것을 즐기고, 공동체 안에서 신앙을 키우는 스타일.",
        "S": "혼자서 깊이 묵상하고 개인적인 만남을 선호하는 스타일.",
        "E": "느낌과 체험을 중시하며 신앙을 생생하게 경험하는 스타일.",
        "W": "말씀과 이성을 중심으로 차분하게 접근하는 스타일.",
        "D": "하나님을 친밀한 아버지, 친구로 여기는 스타일.",
        "P": "하나님의 법과 기준을 중시하는 스타일.",
        "O": "계획적이고 체계적인 신앙생활을 선호하는 스타일.",
        "F": "자유롭고 융통성 있는 신앙생활을 선호하는 스타일."
      };

      const shortCodes = [types[0][0], types[1][0], types[2][0], types[3][0]];
      const finalType = shortCodes.join("-");
      const typeInfo = typeData.find(item => item.type === finalType);

      let detailHtml = `
        <p><strong>공동체 참여성향:</strong> ${types[0]} - ${descriptions[types[0][0]]}</p>
        <p><strong>신앙 표현방식:</strong> ${types[1]} - ${descriptions[types[1][0]]}</p>
        <p><strong>하나님 인식방식:</strong> ${types[2]} - ${descriptions[types[2][0]]}</p>
        <p><strong>신앙생활 패턴:</strong> ${types[3]} - ${descriptions[types[3][0]]}</p>
        <hr>
      `;

      let resultHtml = `
        <h2>최종 유형: ${finalType}</h2>
        ${detailHtml}
        <div id="nickname">${typeInfo ? typeInfo.nickname : ""}</div>
        <div id="catchphrase">${typeInfo ? typeInfo.catchphrase : ""}</div>
        <div id="description">${typeInfo ? typeInfo.description : ""}</div>
      `;
      document.getElementById('result').innerHTML = resultHtml;

      const categoryInfo = [
        { category: "공동체 참여성향", left: "R (교제형)", right: "S (묵상형)" },
        { category: "신앙 표현방식", left: "E (체험형)", right: "W (말씀형)" },
        { category: "하나님 인식방식", left: "D (관계중심형)", right: "P (원칙중심형)" },
        { category: "신앙생활 패턴", left: "O (정돈형)", right: "F (유연형)" }
      ];

      const colors = ["#4a90e2", "#50c878", "#ffb347", "#ff6666"];

      const slidersContainer = document.getElementById('sliders');
      categoryInfo.forEach((info, index) => {
        const score = scores[index];
        const percent = Math.round((score / 20) * 100);

        const wrapper = document.createElement('div');
        wrapper.className = 'axis-wrapper';

        const axis = document.createElement('div');
        axis.className = 'axis';
        axis.innerHTML = `
          <span class="left">${info.left}</span>
          <div class="bar" style="background:${colors[index]}33;">
            <div class="indicator" style="left:${percent}%; background:${colors[index]};" data-percent="${percent}"></div>
          </div>
          <span class="right">${info.right}</span>
        `;

        wrapper.innerHTML = `<div class="category">${info.category}</div>`;
        wrapper.appendChild(axis);
        slidersContainer.appendChild(wrapper);
      });
    }

    document.getElementById('saveBtn').addEventListener('click', () => {
      const resultBox = document.getElementById('result-box');
      html2canvas(resultBox).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = '신앙유형검사결과.png';
        link.click();
      });
    });
  </script>
</body>
</html>
