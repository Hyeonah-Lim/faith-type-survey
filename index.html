<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FATI 신앙유형검사 - Faith Attitude Type Indicator</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* 모든 요소에 대한 기본 스타일 초기화 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary: #5B72EE;
            --primary-dark: #4A5FDB;
            --secondary: #FF6B9D;
            --background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --text-dark: #2c3e50;
            --text-light: #495057;
            --gray-light: #f8f9fa;
            --gray-medium: #e9ecef;
            --circle-size: 50px; /* 모든 원의 크기 동일 */

            /* 새로 추가된 색상 변수 */
            --color-blue: #667eea;
            --color-purple: #764ba2;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overflow-x: hidden;
            color: var(--text-dark);
        }
        
        .container {
            min-height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            flex-direction: column;
        }
        
        .start-screen, .test-screen, .result-screen {
            display: none;
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
            color: white;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .catchphrase { font-size: 16px; opacity: 0.95; margin-bottom: 20px; font-style: italic; letter-spacing: 0.5px; }
        .logo { font-size: 80px; margin-bottom: 30px; animation: pulse 2s ease-in-out infinite; }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .start-screen h1 { font-size: 36px; font-weight: 700; margin-bottom: 10px; }
        .start-screen .english-title { font-size: 18px; opacity: 0.9; margin-bottom: 25px; font-style: italic; }
        
        .fati-explanation { background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 20px; padding: 25px; margin-bottom: 30px; text-align: left; max-width: 400px; }
        .fati-explanation h3 { font-size: 20px; margin-bottom: 15px; text-align: center; }
        .fati-explanation .fati-item { margin: 10px 0; font-size: 14px; line-height: 1.5; }
        .fati-explanation .fati-item strong { color: #FFE66D; font-weight: 600; }
        
        .start-btn { background: white; color: var(--primary); border: none; padding: 18px 60px; border-radius: 30px; font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .start-btn:hover { transform: translateY(-2px); box-shadow: 0 15px 40px rgba(0,0,0,0.3); }
        .start-btn:active { transform: scale(0.95); }
        
        /* 검사 화면 스타일 */
        .test-screen {
            background: white;
            min-height: 100vh;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .header { background: var(--background); padding: 20px; padding-top: calc(20px + env(safe-area-inset-top)); color: white; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .progress-container { background: rgba(255,255,255,0.2); height: 6px; border-radius: 3px; overflow: hidden; margin-top: 10px; max-width: 400px; margin-left: auto; margin-right: auto; }
        .progress-bar { height: 100%; background: white; border-radius: 3px; transition: width 0.5s ease; box-shadow: 0 0 10px rgba(255,255,255,0.5); }
        
        .question-container {
            padding: 30px 20px;
            padding-bottom: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 180px);
            text-align: center;
        }
        
        .question-number { color: var(--primary); font-weight: 600; font-size: 14px; margin-bottom: 15px; }
        .question-text { font-size: 22px; font-weight: 600; line-height: 1.5; margin-bottom: 30px; color: var(--text-dark); text-align: center; max-width: 90%; }
        
        .options-scale {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: nowrap;
            padding: 0 10px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        .options-scale .option-text-wrapper {
            flex-basis: 30%;
            flex-shrink: 1;
            text-align: center;
            font-size: 14px;
            color: var(--text-light);
            line-height: 1.4;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: var(--circle-size);
        }

        .options-scale .circle-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            gap: 10px;
        }

        .options-scale .option-circle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-basis: 0;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            padding: 5px;
        }

        .options-scale .option-circle {
            border-radius: 50%;
            background: var(--gray-light);
            border: 2px solid var(--gray-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
            width: var(--circle-size);
            height: var(--circle-size);
        }

        /* 선택된 옵션 스타일 (색상 변경) */
        .options-scale input[type="radio"]:checked + .option-circle-container .option-circle {
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border-color: transparent;
        }

        /* 왼쪽 두 개 선택 시 색상 */
        .options-scale input[type="radio"].left-option:checked + .option-circle-container .option-circle {
            background: var(--color-blue);
        }
        /* 오른쪽 두 개 선택 시 색상 */
        .options-scale input[type="radio"].right-option:checked + .option-circle-container .option-circle {
            background: var(--color-purple);
        }
        
        .options-scale input[type="radio"] { display: none; }
        
        .navigation { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px 20px; padding-bottom: calc(15px + env(safe-area-inset-bottom)); box-shadow: 0 -2px 15px rgba(0,0,0,0.1); display: flex; gap: 12px; z-index: 100; }
        .nav-btn { flex: 1; padding: 16px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .nav-btn.prev { background: var(--gray-medium); color: var(--text-light); }
        .nav-btn.next { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .nav-btn:active:not(:disabled) { transform: scale(0.95); }
        
        /* 결과 화면 스타일 */
        .result-screen { display: none; background: white; min-height: 100vh; animation: fadeIn 0.5s ease; }
        .result-header { background: var(--background); padding: 50px 20px 60px; padding-top: calc(50px + env(safe-area-inset-top)); text-align: center; color: white; position: relative; overflow: hidden; }
        .result-header::after { content: ''; position: absolute; bottom: -2px; left: 0; right: 0; height: 60px; background: white; border-radius: 30px 30px 0 0; }
        
        .type-badge { display: inline-block; background: rgba(255,255,255,0.2); padding: 8px 20px; border-radius: 20px; font-size: 14px; margin-bottom: 20px; }
        .type-code { font-size: 48px; font-weight: 800; margin: 15px 0; letter-spacing: 3px; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        .type-emoji { font-size: 64px; margin: 20px 0; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2)); }
        .type-nickname { font-size: 28px; font-weight: 600; margin-bottom: 30px; position: relative; z-index: 1; }
        
        .result-content { padding: 40px 20px; position: relative; z-index: 10; }
        .card { background: var(--gray-light); border-radius: 20px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .card h3 { color: var(--text-dark); font-size: 18px; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .card p { color: var(--text-light); line-height: 1.7; font-size: 15px; }
        
        .traits { list-style: none; margin-top: 15px; }
        .traits li { padding: 12px 0; color: var(--text-light); font-size: 15px; display: flex; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--gray-medium); }
        .traits li:last-child { border-bottom: none; }
        .traits li::before { content: '✨'; flex-shrink: 0; }
        
        .score-visualization { background: white; border: 2px solid var(--gray-medium); border-radius: 20px; padding: 25px; margin: 20px 0; }
        .score-row { margin: 25px 0; }
        .score-labels { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px; }
        .score-label { color: var(--text-light); font-weight: 600; }
        .score-label.active { color: var(--primary); font-weight: 700; }
        .score-bar-container { position: relative; height: 12px; background: var(--gray-medium); border-radius: 6px; overflow: hidden; }
        .score-bar-center { position: absolute; left: 50%; top: 0; bottom: 0; width: 3px; background: var(--text-dark); opacity: 0.7; z-index: 1; }
        .score-fill-left { position: absolute; right: 50%; top: 0; height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 6px 0 0 6px; transition: width 1s ease; }
        .score-fill-right { position: absolute; left: 50%; top: 0; height: 100%; background: linear-gradient(90deg, #764ba2, #667eea); border-radius: 0 6px 6px 0; transition: width 1s ease; }
        
        .actions { padding: 20px; padding-bottom: calc(30px + env(safe-area-inset-bottom)); }
        .action-btn { width: 100%; padding: 18px; border: none; border-radius: 16px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; margin-bottom: 12px; }
        .action-btn.primary { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .action-btn.secondary { background: var(--gray-light); color: var(--text-light); }
        .action-btn:active { transform: scale(0.95); }
        
        .copyright { text-align: center; padding: 20px; color: var(--text-light); font-size: 12px; background: var(--gray-light); line-height: 1.6; }
        .copyright strong { color: var(--text-dark); }
        
        /* 로딩 애니메이션 */
        .loading { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; z-index: 1000; background: rgba(255, 255, 255, 0.8); padding: 30px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .loading-spinner { width: 50px; height: 50px; border: 3px solid var(--gray-medium); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* 반응형 디자인: 태블릿 및 데스크톱 */
        @media (min-width: 768px) {
            .container { max-width: 600px; margin: 0 auto; box-shadow: 0 0 50px rgba(0,0,0,0.1); }
        }

        /* 모바일 반응형 디자인 (767px 이하) */
        @media (max-width: 767px) {
            .options-scale { flex-direction: column; align-items: center; gap: 15px; padding: 0 5px; }
            .options-scale .option-text-wrapper { width: 100%; flex-basis: auto; min-height: auto; text-align: center; padding: 0 10px; }
            .options-scale .circle-wrapper { width: 100%; justify-content: center; gap: 8px; }
            .options-scale .option-circle.large { width: var(--circle-size); height: var(--circle-size); }
            .options-scale .option-circle.small { width: var(--circle-size); height: var(--circle-size); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="start-screen" id="startScreen">
            <div class="catchphrase">나만의 독특한 신앙 스타일을 발견해보세요</div>
            <div class="logo">🙏</div>
            <h1>FATI 신앙유형검사</h1>
            <div class="english-title">Faith Attitude Type Indicator</div>
            
            <div class="fati-explanation">
                <h3>FATI란?</h3>
                <div class="fati-item"><strong>F</strong>ellowship - 공동체 참여 성향 (R/S)</div>
                <div class="fati-item"><strong>A</strong>ffection - 신앙 표현 방식 (E/W)</div>
                <div class="fati-item"><strong>T</strong>heology - 하나님 인식 방식 (D/P)</div>
                <div class="fati-item"><strong>I</strong>ntention - 신앙생활 패턴 (O/F)</div>
            </div>
            
            <button class="start-btn" onclick="startTest()">시작하기</button>
            <div style="margin-top: 30px; font-size: 14px; opacity: 0.8;">
                ⏱ 약 5분 소요 | 📝 20문항
            </div>
        </div>
        
        <div class="test-screen" id="testScreen">
            <div class="header">
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>
            
            <div class="question-container">
                <div class="question-number" id="questionNumber"></div>
                <div class="question-text" id="questionText"></div>
                <div class="options-scale" id="optionsContainer">
                    </div>
            </div>
            
            <div class="navigation">
                <button class="nav-btn prev" id="prevBtn" onclick="previousQuestion()">이전</button>
                <button class="nav-btn next" id="nextBtn" onclick="nextQuestion()" disabled>다음</button>
            </div>
        </div>
        
        <div class="result-screen" id="resultScreen">
            <div class="result-header">
                <div class="type-badge">당신의 신앙유형</div>
                <div class="type-emoji" id="typeEmoji"></div>
                <div class="type-code" id="typeCode"></div>
                <div class="type-nickname" id="typeNickname"></div>
            </div>
            
            <div class="result-content">
                <div class="card">
                    <h3>📖 유형 설명</h3>
                    <p id="typeDescription"></p>
                </div>
                
                <div class="card">
                    <h3>✨ 주요 특징</h3>
                    <ul class="traits" id="traitsList"></ul>
                </div>
                
                <div class="score-visualization">
                    <h3 style="margin-bottom: 25px; text-align: center;">🎯 상세 분석</h3>
                    <div id="scoreDetails"></div>
                </div>
                
                <div class="card">
                    <h3>💡 성장 포인트</h3>
                    <p id="growthPoint"></p>
                </div>
                
                <div class="card">
                    <h3>🤝 잘 맞는 유형</h3>
                    <p id="compatibility"></p>
                </div>
            </div>
            
            <div class="actions">
                <button class="action-btn primary" onclick="shareResult()">📤 결과 링크 복사하기</button>
                <button class="action-btn secondary" onclick="downloadResultImage()">🖼️ 결과 이미지 다운로드</button>
                <button class="action-btn secondary" onclick="restartTest()">🔄 다시 검사하기</button>
            </div>
            
            <div class="copyright">
                <strong>FATI 신앙유형검사</strong><br>
                Original Idea by <strong>문은성, 송은서</strong><br>
                Developed by <strong>임현아</strong><br>
                © 2025 All rights reserved
            </div>
        </div>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
        </div>
    </div>
    
    <script>
        // 문항 데이터
        const questions = [
            // 공동체 참여 성향 (R/S) - R: 관계 지향, S: 독립 지향
            { category: '공동체 참여 성향', text: '🎵 성가대 연습에 10분 늦은 당신! 모두가 먼저 와 있고, 당신만 눈치 보며 들어간 상황에서…', leftText: '가볍게 사과하고 주변에 자연스럽게 섞이는 편이다.', rightText: '누구도 말 안 걸었으면 하고 그냥 묵묵히 앉아있는 편이다.', leftType: 'R', rightType: 'S' },
            { category: '공동체 참여 성향', text: '🙋 청년부에 새로 온 지체가 혼자 앉아있다.', leftText: '반가운 마음으로 먼저 다가가 말을 건넨다.', rightText: '어색해서 다가가긴 어렵지만 조용히 관심을 갖고 기회가 되면 개인적으로 대화한다.', leftType: 'R', rightType: 'S' },
            { category: '공동체 참여 성향', text: '📆 수련회에 참석하게 된 당신, 가장 기대하는 것은?', leftText: '많은 사람들과 함께 뜨거운 예배를 드리는 것', rightText: '혼자만의 시간에 뜨겁게 기도하는 것', leftType: 'R', rightType: 'S' },
            { category: '공동체 참여 성향', text: '🧠 신앙적인 고민이 깊어진 시기, 당신은?', leftText: '신앙 친구들과 나누며 함께 기도한다.', rightText: '혼자 하나님께 기도하며 답을 구한다.', leftType: 'R', rightType: 'S' },
            { category: '공동체 참여 성향', text: '❓ 교회 재정이나 헌금에 대해 내 마음은?', leftText: '공동체가 함께 사용하는 것이라 기꺼이 나누고 싶은 마음이다.', rightText: '조용히 하나님 앞에서 결정하고 헌금은 개인적인 헌신이라고 생각한다.', leftType: 'R', rightType: 'S' },
            // 신앙 표현방식 (E/W) - E: 감정/경험 지향, W: 이성/원리 지향
            { category: '신앙 표현방식', text: '🎤 썸워십에 참석한 당신, 어떤 스타일인가요?', leftText: '몸으로 표현하며 감정이 우러나는 찬양을 좋아한다', rightText: '가사의 의미를 생각하며 조용히 마음으로 부른다', leftType: 'E', rightType: 'W' },
            { category: '신앙 표현방식', text: '📖 말씀 듣는 중, 당신의 자세는?', leftText: '말씀을 통해 받은 감동과 느낌을 중심으로 정리한다.', rightText: '논리적 흐름과 단어의 뜻을 구조적으로 정리한다.', leftType: 'E', rightType: 'W' },
            { category: '신앙 표현방식', text: '🙏 기도응답을 경험했을 때', leftText: '하나님이 살아계심을 느꼈다는 체험에 집중한다.', rightText: '하나님의 뜻이 무엇인지 깨달은 것에 집중한다.', leftType: 'E', rightType: 'W' },
            { category: '신앙 표현방식', text: '💬 수련회 이후, 목장 사람들과 함께 간증 나눔을 하게 된 당신', leftText: '하나님을 경험한 순간의 감정과 느낌을 자세히 나눈다', rightText: '하나님이 어떤 방법으로 역사하셨는지 사실 중심으로 나눈다', leftType: 'E', rightType: 'W' },
            { category: '신앙 표현방식', text: '💰 재정이나 시간의 우선순위를 정할 때 기준은?', leftText: '마음속에서 하나님이 주신 감동이나 흐름을 따른다.', rightText: '말씀을 통해 배우고 적용한 원칙을 중심으로 판단한다.', leftType: 'E', rightType: 'W' },
            // 하나님 인식방식 (D/P) - D: 관계/친밀함 지향, P: 권위/주권 지향
            { category: '하나님 인식방식', text: '📖 성경을 읽을 때 가장 먼저 드는 감정은?', leftText: '하나님이 내게 말 걸어 주시는 듯한 친밀감을 느끼는 편이다', rightText: '하나님의 명령과 기준이 무엇인지 찾는 편이다', leftType: 'D', rightType: 'P' },
            { category: '하나님 인식방식', text: '🙏 기도할 때, 당신은 하나님을 어떻게 그리는가?', leftText: '내가 힘들 때 안아 주시는 따뜻한 분', rightText: '내 삶을 판단하고 이끄시는 기준이자 주권자', leftType: 'D', rightType: 'P' },
            { category: '하나님 인식방식', text: '🧭 믿음의 결정을 내려야 할 때, 당신은?', leftText: '마음에 평안이 있는지를 중심으로 분별한다.', rightText: '말씀의 기준에 맞는지를 따져본다.', leftType: 'D', rightType: 'P' },
            { category: '하나님 인식방식', text: '✝️ 신앙생활의 주된 동기는', leftText: '하나님과의 더 깊은 사랑의 관계를 위해', rightText: '하나님이 기뻐하시는 올바른 삶을 살기 위해', leftType: 'D', rightType: 'P' },
            { category: '하나님 인식방식', text: '🙌 하나님께 헌신을 결단할 때, 어떤 마음이 앞서는가?', leftText: '하나님께 사랑받고 있다는 감격이 헌신의 원동력이다.', rightText: '하나님의 뜻에 순종하는 것이 당연하다는 책임감이 앞선다.', leftType: 'D', rightType: 'P' },
            // 신앙생활 패턴 (O/F) - O: 조직/계획 지향, F: 유연/자유 지향
            { category: '신앙생활 패턴', text: '📆 수련회 전날 밤, 당신은?', leftText: '짐, 일정, 말씀 다 정리하고 기도까지 마친 상태다.', rightText: '마음 가는 대로 내일 아침에 짐 싸도 괜찮다.', leftType: 'O', rightType: 'F' },
            { category: '신앙생활 패턴', text: '📖 성경 읽기를 시작하려는 당신.', leftText: '계획표를 세워 하루 분량을 지키려고 노력하는 편이다.', rightText: '마음에 끌리는 본문 위주로 자유롭게 읽는 편이다.', leftType: 'O', rightType: 'F' },
            { category: '신앙생활 패턴', text: '📝 기도제목을 기록하는 방식은?', leftText: '날짜별로 정리된 노트나 앱을 사용하는 편이다.', rightText: '떠오를 때 간단히 메모하는 편이다.', leftType: 'O', rightType: 'F' },
            { category: '신앙생활 패턴', text: '신앙생활을 실천하는 나만의 방식은?', leftText: '신앙생활은 계획적으로 실천하는 것이 중요하다고 생각한다.', rightText: '신앙생활은 흐름에 따라 자연스럽게 이어지는 것이 더 의미 있다고 생각한다.', leftType: 'O', rightType: 'F' },
            { category: '신앙생활 패턴', text: '🎁 헌금이나 봉사를 할 때의 나는?', leftText: '미리 계획하고 정해둔 방식대로 정기적으로 실천한다.', rightText: '마음이 감동되었을 때 자발적으로 드리고 참여하는 편이다.', leftType: 'O', rightType: 'F' }
        ];

        // 각 유형별 결과 설명
        const resultTypes = {
            'REDO': { emoji: '💖', nickname: '사랑 넘치는 공동체 리더', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'REDF': { emoji: '🌊', nickname: '자유로운 사랑의 파도', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'REPO': { emoji: '🌈', nickname: '감격의 무지개', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'REPF': { emoji: '🎆', nickname: '정의로운 카타르시스', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SEDO': { emoji: '💎', nickname: '깊이있는 영적 탐구자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SEDF': { emoji: '🏞️', nickname: '경건한 영혼의 순례자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SEPO': { emoji: '⚖️', nickname: '말씀의 설계자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SEPF': { emoji: '🌌', nickname: '지혜로운 우주 여행자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'RWDO': { emoji: '🤝', nickname: '진정한 동역자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'RWDF': { emoji: '🌱', nickname: '따뜻한 영혼의 정원사', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'RWPO': { emoji: '🏰', nickname: '하나님 나라의 건축가', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'RWPF': { emoji: '🔑', nickname: '사랑의 열쇠지기', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SWDO': { emoji: '📚', nickname: '조직적인 성경학자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SWDF': { emoji: '🕊️', nickname: '고요한 묵상가', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SWPO': { emoji: '🛡️', nickname: '진리의 수호자', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' },
            'SWPF': { emoji: '💡', nickname: '깨달음의 등불', description: '...', traits: ['...', '...'], growth: '...', compatibility: '...' }
        };

        let currentQuestionIndex = 0;
        let answers = {};
        let score = { 'R': 0, 'S': 0, 'E': 0, 'W': 0, 'D': 0, 'P': 0, 'O': 0, 'F': 0 };

        // 화면 전환 함수
        function showScreen(screenId) {
            document.querySelectorAll('.container > div').forEach(div => div.style.display = 'none');
            document.getElementById(screenId).style.display = 'flex';
        }

        // 테스트 시작
        function startTest() {
            currentQuestionIndex = 0;
            answers = {};
            score = { 'R': 0, 'S': 0, 'E': 0, 'W': 0, 'D': 0, 'P': 0, 'O': 0, 'F': 0 };
            showScreen('testScreen');
            renderQuestion();
        }

        // 질문 렌더링
        function renderQuestion() {
            const question = questions[currentQuestionIndex];
            const qNumEl = document.getElementById('questionNumber');
            const qTextEl = document.getElementById('questionText');
            const optionsContainer = document.getElementById('optionsContainer');
            const progressBar = document.getElementById('progressBar');
            const nextBtn = document.getElementById('nextBtn');
            const prevBtn = document.getElementById('prevBtn');

            qNumEl.textContent = `Q${currentQuestionIndex + 1}/${questions.length}`;
            qTextEl.textContent = question.text;

            // 선택지 동적 생성
            optionsContainer.innerHTML = `
                <div class="option-text-wrapper left-text">
                    <span class="option-number">1.</span>
                    <span class="option-text">${question.leftText}</span>
                </div>
                <div class="circle-wrapper">
                    <label class="option-circle-container">
                        <input type="radio" name="option-${currentQuestionIndex}" value="1" class="left-option">
                        <div class="option-circle"></div>
                    </label>
                    <label class="option-circle-container">
                        <input type="radio" name="option-${currentQuestionIndex}" value="2" class="left-option">
                        <div class="option-circle"></div>
                    </label>
                    <label class="option-circle-container">
                        <input type="radio" name="option-${currentQuestionIndex}" value="3" class="right-option">
                        <div class="option-circle"></div>
                    </label>
                    <label class="option-circle-container">
                        <input type="radio" name="option-${currentQuestionIndex}" value="4" class="right-option">
                        <div class="option-circle"></div>
                    </label>
                </div>
                <div class="option-text-wrapper right-text">
                    <span class="option-number">2.</span>
                    <span class="option-text">${question.rightText}</span>
                </div>
            `;
            
            // 기존 답변이 있으면 선택 상태 복원
            if (answers[currentQuestionIndex]) {
                document.querySelector(`input[name="option-${currentQuestionIndex}"][value="${answers[currentQuestionIndex]}"]`).checked = true;
                nextBtn.disabled = false;
            } else {
                nextBtn.disabled = true;
            }

            // 라디오 버튼 이벤트 리스너 추가
            document.querySelectorAll(`input[name="option-${currentQuestionIndex}"]`).forEach(radio => {
                radio.addEventListener('change', () => {
                    nextBtn.disabled = false;
                    answers[currentQuestionIndex] = radio.value;
                });
            });

            // 이전/다음 버튼 상태 업데이트
            prevBtn.disabled = currentQuestionIndex === 0;
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // 다음 질문
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            } else {
                calculateResult();
            }
        }

        // 이전 질문
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }

        // 결과 계산 및 표시
        function calculateResult() {
            showScreen('loading');

            // 1초 뒤 결과 화면 표시 (로딩 효과)
            setTimeout(() => {
                score = { 'R': 0, 'S': 0, 'E': 0, 'W': 0, 'D': 0, 'P': 0, 'O': 0, 'F': 0 };
                
                for (let i = 0; i < questions.length; i++) {
                    const question = questions[i];
                    const answer = parseInt(answers[i]);

                    // 1, 2는 leftType, 3, 4는 rightType에 점수 부여
                    // 크기가 커짐에 따라 점수를 높게 부여
                    if (answer === 1) score[question.leftType] += 4;
                    else if (answer === 2) score[question.leftType] += 2;
                    else if (answer === 3) score[question.rightType] += 2;
                    else if (answer === 4) score[question.rightType] += 4;
                }
                
                const typeF = score['R'] > score['S'] ? 'R' : 'S';
                const typeA = score['E'] > score['W'] ? 'E' : 'W';
                const typeT = score['D'] > score['P'] ? 'D' : 'P';
                const typeI = score['O'] > score['F'] ? 'O' : 'F';
                
                const finalType = typeF + typeA + typeT + typeI;
                displayResult(finalType);
            }, 1000);
        }

        // 결과 화면 표시
        function displayResult(finalType) {
            const resultData = resultTypes[finalType];
            if (!resultData) {
                // 결과 데이터가 없을 경우 처리
                document.getElementById('resultScreen').innerHTML = '결과 데이터를 찾을 수 없습니다.';
                showScreen('resultScreen');
                return;
            }

            document.getElementById('typeEmoji').textContent = resultData.emoji;
            document.getElementById('typeCode').textContent = finalType;
            document.getElementById('typeNickname').textContent = resultData.nickname;
            document.getElementById('typeDescription').textContent = resultData.description;
            document.getElementById('growthPoint').textContent = resultData.growth;
            document.getElementById('compatibility').textContent = resultData.compatibility;
            
            const traitsListEl = document.getElementById('traitsList');
            traitsListEl.innerHTML = resultData.traits.map(trait => `<li>${trait}</li>`).join('');

            // 상세 분석 시각화
            const scoreDetailsEl = document.getElementById('scoreDetails');
            const totalScoreR_S = score['R'] + score['S'];
            const totalScoreE_W = score['E'] + score['W'];
            const totalScoreD_P = score['D'] + score['P'];
            const totalScoreO_F = score['O'] + score['F'];

            scoreDetailsEl.innerHTML = `
                <div class="score-row">
                    <div class="score-labels">
                        <span class="score-label ${score['R'] > score['S'] ? 'active' : ''}">R (관계)</span>
                        <span class="score-label ${score['R'] < score['S'] ? 'active' : ''}">S (독립)</span>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar-center"></div>
                        <div class="score-fill-left" style="width: ${totalScoreR_S > 0 ? (score['R'] / totalScoreR_S) * 100 : 50}%;"></div>
                        <div class="score-fill-right" style="width: ${totalScoreR_S > 0 ? (score['S'] / totalScoreR_S) * 100 : 50}%;"></div>
                    </div>
                </div>
                <div class="score-row">
                    <div class="score-labels">
                        <span class="score-label ${score['E'] > score['W'] ? 'active' : ''}">E (감정)</span>
                        <span class="score-label ${score['E'] < score['W'] ? 'active' : ''}">W (원리)</span>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar-center"></div>
                        <div class="score-fill-left" style="width: ${totalScoreE_W > 0 ? (score['E'] / totalScoreE_W) * 100 : 50}%;"></div>
                        <div class="score-fill-right" style="width: ${totalScoreE_W > 0 ? (score['W'] / totalScoreE_W) * 100 : 50}%;"></div>
                    </div>
                </div>
                <div class="score-row">
                    <div class="score-labels">
                        <span class="score-label ${score['D'] > score['P'] ? 'active' : ''}">D (친밀)</span>
                        <span class="score-label ${score['D'] < score['P'] ? 'active' : ''}">P (권위)</span>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar-center"></div>
                        <div class="score-fill-left" style="width: ${totalScoreD_P > 0 ? (score['D'] / totalScoreD_P) * 100 : 50}%;"></div>
                        <div class="score-fill-right" style="width: ${totalScoreD_P > 0 ? (score['P'] / totalScoreD_P) * 100 : 50}%;"></div>
                    </div>
                </div>
                <div class="score-row">
                    <div class="score-labels">
                        <span class="score-label ${score['O'] > score['F'] ? 'active' : ''}">O (계획)</span>
                        <span class="score-label ${score['O'] < score['F'] ? 'active' : ''}">F (유연)</span>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar-center"></div>
                        <div class="score-fill-left" style="width: ${totalScoreO_F > 0 ? (score['O'] / totalScoreO_F) * 100 : 50}%;"></div>
                        <div class="score-fill-right" style="width: ${totalScoreO_F > 0 ? (score['F'] / totalScoreO_F) * 100 : 50}%;"></div>
                    </div>
                </div>
            `;

            showScreen('resultScreen');
        }

        // 결과 이미지 다운로드 함수
        function downloadResultImage() {
            const resultScreen = document.getElementById('resultScreen');
            const loading = document.getElementById('loading');
            loading.style.display = 'flex';

            html2canvas(resultScreen, {
                scale: 2,
                backgroundColor: null,
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = `FATI_${document.getElementById('typeCode').textContent}_결과.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                loading.style.display = 'none';
            }).catch(err => {
                console.error("이미지 다운로드 실패:", err);
                loading.style.display = 'none';
                alert('이미지 다운로드에 실패했습니다. 다시 시도해 주세요.');
            });
        }
        
        // 다시 검사하기
        function restartTest() {
            showScreen('startScreen');
        }

        // 페이지 로드 시 시작 화면 표시
        window.onload = function() {
            showScreen('startScreen');
        };
    </script>
</body>
</html>