<!DOCTYPE html> 
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SCTI ì„±ë½êµíšŒ ì„±í–¥ê²€ì‚¬ - Sungrak Church Type Indicator</title>
    <!-- html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* ëª¨ë“  ìš”ì†Œì— ëŒ€í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* CSS ë³€ìˆ˜ ì •ì˜ */
        :root {
            --primary: #5B72EE;
            --primary-dark: #4A5FDB;
            --secondary: #FF6B9D;
            --background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --text-dark: #2c3e50;
            --text-light: #495057;
            --gray-light: #f8f9fa;
            --gray-medium: #e9ecef;
            --circle-large-size: 60px;
            --circle-small-size: 40px;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overflow-x: hidden;
            color: var(--text-dark);
        }
        
        .container {
            min-height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            flex-direction: column;
        }
        
        /* ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
            color: white;
            animation: fadeIn 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .catchphrase {
            font-size: 16px;
            opacity: 0.95;
            margin: 20px 0;
            font-style: italic;
            letter-spacing: 0.5px;
            text-align: center;
            display: block;
            position: relative;
            z-index: 2;
        }
        
        .logo {
            font-size: 80px;
            margin-bottom: 30px;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .start-screen h1 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .start-screen .english-title {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 25px;
            font-style: italic;
        }
        
        .scti-explanation {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: left;
            max-width: 400px;
        }
        
        .scti-explanation h3 {
            font-size: 20px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .scti-explanation .description {
            font-size: 14px;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 20px;
            opacity: 0.9;
        }
        
        .scti-explanation .scti-item {
            margin: 12px 0;
            font-size: 14px;
            line-height: 1.5;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .scti-explanation .scti-item .letter {
            background: #FFE66D;
            color: #764ba2;
            font-weight: 700;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .scti-explanation .scti-item .meaning {
            flex: 1;
        }
        
        .start-btn {
            background: white;
            color: var(--primary);
            border: none;
            padding: 18px 60px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        
        .start-btn:active {
            transform: scale(0.95);
        }
        
        /* ê²€ì‚¬ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .test-screen {
            display: none;
            background: white;
            min-height: 100vh;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .header {
            background: var(--background);
            padding: 20px;
            padding-top: calc(20px + env(safe-area-inset-top));
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .progress-container {
            background: rgba(255,255,255,0.2);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .progress-bar {
            height: 100%;
            background: white;
            border-radius: 3px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        
        .question-container {
            padding: 30px 20px;
            padding-bottom: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 180px);
            text-align: center;
        }
        
        .question-number {
            color: var(--primary);
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .question-text {
            font-size: 22px;
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 30px;
            color: var(--text-dark);
            text-align: center;
            max-width: 90%;
        }
        
        /* ì§ˆë¬¸ ì„ íƒì§€ ë ˆì´ì•„ì›ƒ - ë°ìŠ¤í¬í†± */
        .options-scale {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            flex-wrap: nowrap;
            padding: 0 10px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        .options-scale .option-text-wrapper {
            flex-basis: 30%;
            flex-shrink: 1;
            text-align: center;
            font-size: 14px;
            color: var(--text-light);
            line-height: 1.4;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: var(--circle-large-size);
            padding: 10px;
            background: var(--gray-light);
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        /* ì„ íƒëœ í…ìŠ¤íŠ¸ ê°•ì¡° */
        .options-scale .option-text-wrapper.selected-left,
        .options-scale .option-text-wrapper.selected-right {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-color: var(--primary);
            font-weight: 500;
        }

        /* ì›í˜• ë²„íŠ¼ë“¤ì„ ê°ì‹¸ëŠ” ë˜í¼ */
        .options-scale .circle-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            gap: 10px;
        }

        .options-scale .option-circle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-basis: 0;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            padding: 5px;
        }

        .options-scale .option-circle {
            border-radius: 50%;
            background: var(--gray-light);
            border: 2px solid var(--gray-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }

        .options-scale .option-circle.large {
            width: var(--circle-large-size);
            height: var(--circle-large-size);
        }

        .options-scale .option-circle.small {
            width: var(--circle-small-size);
            height: var(--circle-small-size);
        }

        .options-scale input[type="radio"]:checked + .option-circle-container .option-circle {
            background: var(--secondary);
            border-color: var(--secondary);
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .options-scale input[type="radio"] {
            display: none;
        }

        .options-scale .option-circle-container:hover .option-circle {
            background: var(--gray-medium);
        }
        
        /* ëª¨ë°”ì¼ ì „ìš© í…ìŠ¤íŠ¸ í‘œì‹œ */
        .mobile-text-display {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: var(--gray-light);
            border-radius: 12px;
            max-width: 90%;
            margin-left: auto;
            margin-right: auto;
        }
        
        .mobile-text-display .left-indicator,
        .mobile-text-display .right-indicator {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .mobile-text-display .left-indicator {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
        }
        
        .mobile-text-display .right-indicator {
            background: linear-gradient(90deg, #764ba2, #667eea);
            color: white;
        }
        
        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 20px;
            padding-bottom: calc(15px + env(safe-area-inset-bottom));
            box-shadow: 0 -2px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 12px;
            z-index: 100;
        }
        
        .nav-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .nav-btn.prev {
            background: var(--gray-medium);
            color: var(--text-light);
        }
        
        .nav-btn.next {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .nav-btn:active:not(:disabled) {
            transform: scale(0.95);
        }
        
        /* ê²°ê³¼ í™”ë©´ ìŠ¤íƒ€ì¼ - ì´ë¯¸ì§€ ì €ì¥ì„ ìœ„í•œ ìˆ˜ì • */
        .result-screen {
            display: none;
            background: white;
            min-height: 100vh;
            animation: fadeIn 0.5s ease;
        }
        
        /* ê²°ê³¼ ì¹´ë“œ - ì´ë¯¸ì§€ ì €ì¥ìš© (ëª¨ë°”ì¼ í¬ê¸°) */
        .result-card-for-image {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 390px; /* iPhone ê¸°ì¤€ ë„ˆë¹„ */
            min-height: 844px; /* iPhone ê¸°ì¤€ ë†’ì´ */
            background: white;
            z-index: 10000;
            overflow: hidden;
        }
        
        .result-card-header {
            background: var(--background);
            padding: 50px 20px 40px;
            text-align: center;
            color: white;
            position: relative;
        }
        
        .result-card-header::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            height: 60px;
            background: white;
            border-radius: 30px 30px 0 0;
        }
        
        .result-card-header .emoji {
            font-size: 72px;
            margin-bottom: 20px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }
        
        .result-card-header .type-code {
            font-size: 42px;
            font-weight: 800;
            letter-spacing: 3px;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .result-card-header .nickname {
            font-size: 24px;
            font-weight: 600;
            opacity: 0.95;
        }
        
        .result-card-body {
            padding: 40px 20px 30px;
            position: relative;
            z-index: 1;
        }
        
        .result-card-body .description {
            color: var(--text-dark);
            line-height: 1.7;
            margin-bottom: 30px;
            font-size: 15px;
            text-align: center;
            padding: 20px;
            background: var(--gray-light);
            border-radius: 16px;
        }
        
        .result-card-body .traits-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .result-card-body .traits-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .result-card-body .traits-list li {
            padding: 15px;
            margin-bottom: 12px;
            background: white;
            border: 2px solid var(--gray-medium);
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-dark);
            display: flex;
            align-items: flex-start;
            gap: 10px;
            transition: all 0.2s;
        }
        
        .result-card-body .traits-list li::before {
            content: 'âœ¨';
            flex-shrink: 0;
            font-size: 16px;
        }
        
        .result-card-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 20px;
            background: var(--gray-light);
            color: var(--text-light);
            font-size: 12px;
            border-top: 1px solid var(--gray-medium);
        }
        
        .result-card-footer .footer-title {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .result-header {
            background: var(--background);
            padding: 50px 20px 60px;
            padding-top: calc(50px + env(safe-area-inset-top));
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .result-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 60px;
            background: white;
            border-radius: 30px 30px 0 0;
        }
        
        .type-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .type-code {
            font-size: 48px;
            font-weight: 800;
            margin: 15px 0;
            letter-spacing: 3px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .type-emoji {
            font-size: 64px;
            margin: 20px 0;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }
        
        .type-nickname {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }
        
        .result-content {
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }
        
        .card {
            background: var(--gray-light);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .card h3 {
            color: var(--text-dark);
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card p {
            color: var(--text-light);
            line-height: 1.7;
            font-size: 15px;
        }
        
        .traits {
            list-style: none;
            margin-top: 15px;
        }
        
        .traits li {
            padding: 12px 0;
            color: var(--text-light);
            font-size: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            border-bottom: 1px solid var(--gray-medium);
        }
        
        .traits li:last-child {
            border-bottom: none;
        }
        
        .traits li::before {
            content: 'âœ¨';
            flex-shrink: 0;
        }
        
        .score-visualization {
            background: white;
            border: 2px solid var(--gray-medium);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .score-row {
            margin: 25px 0;
        }
        
        .score-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .score-label {
            color: var(--text-light);
            font-weight: 600;
        }
        
        .score-label.active {
            color: var(--primary);
            font-weight: 700;
        }
        
        .score-bar-container {
            position: relative;
            height: 12px;
            background: var(--gray-medium);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .score-bar-center {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--text-dark);
            opacity: 0.7;
            z-index: 1;
        }
        
        .score-fill-left {
            position: absolute;
            right: 50%;
            top: 0;
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 6px 0 0 6px;
            transition: width 1s ease;
        }
        
        .score-fill-right {
            position: absolute;
            left: 50%;
            top: 0;
            height: 100%;
            background: linear-gradient(90deg, #764ba2, #667eea);
            border-radius: 0 6px 6px 0;
            transition: width 1s ease;
        }
        
        .actions {
            padding: 20px;
            padding-bottom: calc(30px + env(safe-area-inset-bottom));
        }
        
        .action-btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 12px;
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .action-btn.secondary {
            background: var(--gray-light);
            color: var(--text-light);
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .copyright {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 12px;
            background: var(--gray-light);
            line-height: 1.6;
        }
        
        .copyright strong {
            color: var(--text-dark);
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--gray-medium);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* íƒœë¸”ë¦¿ ë° ë°ìŠ¤í¬í†± */
        @media (min-width: 768px) {
            .container {
                max-width: 600px;
                margin: 0 auto;
                box-shadow: 0 0 50px rgba(0,0,0,0.1);
            }
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ë””ìì¸ (767px ì´í•˜) */
        @media (max-width: 767px) {
            .options-scale {
                flex-direction: column;
                align-items: center;
                gap: 20px;
                padding: 0 5px;
            }
            
            /* ëª¨ë°”ì¼ì—ì„œ í…ìŠ¤íŠ¸ ë˜í¼ ìˆ¨ê¸°ê¸° */
            .options-scale .option-text-wrapper {
                display: none;
            }
            
            /* ëª¨ë°”ì¼ ì „ìš© í…ìŠ¤íŠ¸ í‘œì‹œ ì˜ì—­ ë³´ì´ê¸° */
            .mobile-text-display {
                display: block;
            }

            .options-scale .circle-wrapper {
                width: 100%;
                justify-content: center;
                gap: 8px;
            }

            .options-scale .option-circle.large {
                width: 55px;
                height: 55px;
            }
            
            .options-scale .option-circle.small {
                width: 35px;
                height: 35px;
            }
            
            .question-text {
                font-size: 20px;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ì‹œì‘ í™”ë©´ -->
        <div class="start-screen" id="startScreen">
            <div class="catchphrase">ë‚˜ë§Œì˜ ë…íŠ¹í•œ ì‹ ì•™ ìŠ¤íƒ€ì¼ì„ ë°œê²¬í•´ë³´ì„¸ìš”</div>
            <div class="logo">â›ª</div>
            <h1>SCTI ì„±ë½êµíšŒ ì„±í–¥ê²€ì‚¬</h1>
            <div class="english-title">Sungrak Church Type Indicator</div>
            
            <div class="scti-explanation">
                <h3>ğŸ” SCTIë€?</h3>
                <p class="description">ì„±ë½êµíšŒ ê³µë™ì²´ ì•ˆì—ì„œ ë‚˜ì˜ ì‹ ì•™ ì„±í–¥ì„ ì•Œì•„ë³´ëŠ” ê²€ì‚¬ì…ë‹ˆë‹¤</p>
                
                <div class="scti-item">
                    <div class="letter">S</div>
                    <div class="meaning">Social - ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥ (R/S)</div>
                </div>
                <div class="scti-item">
                    <div class="letter">C</div>
                    <div class="meaning">Character - ì‹ ì•™ í‘œí˜„ ë°©ì‹ (E/W)</div>
                </div>
                <div class="scti-item">
                    <div class="letter">T</div>
                    <div class="meaning">Theology - í•˜ë‚˜ë‹˜ ì¸ì‹ ë°©ì‹ (D/P)</div>
                </div>
                <div class="scti-item">
                    <div class="letter">I</div>
                    <div class="meaning">Implementation - ì‹ ì•™ìƒí™œ íŒ¨í„´ (O/F)</div>
                </div>
            </div>
            
            <button class="start-btn" onclick="startTest()">ì‹œì‘í•˜ê¸°</button>
            <div style="margin-top: 30px; font-size: 14px; opacity: 0.8;">
                â± ì•½ 5ë¶„ ì†Œìš” | ğŸ“ 20ë¬¸í•­
            </div>
        </div>
        
        <!-- ê²€ì‚¬ í™”ë©´ -->
        <div class="test-screen" id="testScreen">
            <div class="header">
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>
            
            <div class="question-container">
                <div class="question-number" id="questionNumber"></div>
                <div class="question-text" id="questionText"></div>
                <div class="options-scale" id="optionsContainer"></div>
                <!-- ëª¨ë°”ì¼ ì „ìš© í…ìŠ¤íŠ¸ í‘œì‹œ ì˜ì—­ -->
                <div class="mobile-text-display" id="mobileTextDisplay" style="display: none;">
                    <div>
                        <span class="left-indicator">â—€ ì™¼ìª½</span>
                        <p id="mobileLeftText" style="margin: 5px 0; font-size: 14px;"></p>
                    </div>
                    <div style="margin-top: 15px;">
                        <span class="right-indicator">ì˜¤ë¥¸ìª½ â–¶</span>
                        <p id="mobileRightText" style="margin: 5px 0; font-size: 14px;"></p>
                    </div>
                </div>
            </div>

            <div class="navigation">
                <button class="nav-btn prev" id="prevBtn" onclick="prevQuestion()" disabled>ì´ì „</button>
                <button class="nav-btn next" id="nextBtn" onclick="nextQuestion()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div class="result-screen" id="resultScreen">
            <div class="result-header">
                <div class="type-badge" id="typeBadge">SCTI ê²°ê³¼</div>
                <div class="type-code" id="resultTypeCode">TYPE</div>
                <div class="type-emoji" id="resultEmoji">âœ¨</div>
                <div class="type-nickname" id="resultNickname">ë‹‰ë„¤ì„</div>
            </div>
            <div class="result-content">
                <div class="card">
                    <h3>ìš”ì•½</h3>
                    <p id="resultDescription">ì„¤ëª…</p>
                </div>

                <div class="card">
                    <h3>ìƒì„¸ ë¶„ì„</h3>
                    <div class="score-visualization" id="scoreVisualization">
                        <!-- ê° ì¶• ë§‰ëŒ€ê°€ ë Œë”ë§ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <div class="card">
                    <h3>íŠ¹ì§•</h3>
                    <ul class="traits" id="resultTraits"></ul>
                </div>
            </div>

            <div class="actions">
                <button class="action-btn primary" onclick="saveResultImage()">ê²°ê³¼ ì´ë¯¸ì§€ ì €ì¥ (ê·¸ë˜í”„ í¬í•¨)</button>
                <button class="action-btn secondary" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
            </div>

            <div class="copyright">
                <strong>SCTI</strong> Â· ì„±ë½êµíšŒ ì²­ë…„ë¶€ Â· ê²°ê³¼ëŠ” ìê¸°ì´í•´ì™€ êµì œì— í™œìš©í•´ ì£¼ì„¸ìš”.
            </div>
        </div>

        <!-- ì´ë¯¸ì§€ ì €ì¥ìš© ì¹´ë“œ (ìˆ¨ê¹€) -->
        <div class="result-card-for-image" id="resultCardForImage">
            <div class="result-card-header">
                <div class="emoji" id="imgEmoji">âœ¨</div>
                <div class="type-code" id="imgTypeCode">TYPE</div>
                <div class="nickname" id="imgNickname">ë‹‰ë„¤ì„</div>
            </div>
            <div class="result-card-body">
                <div class="description" id="imgDescription">ì„¤ëª…</div>

                <div class="traits-title">ë‚˜ì˜ íŠ¹ì§•</div>
                <ul class="traits-list" id="imgTraits"></ul>

                <!-- ë‹¤ìš´ë¡œë“œ ì´ë¯¸ì§€ì—ë„ ìƒì„¸ë¶„ì„ ê·¸ë˜í”„ í¬í•¨ -->
                <div class="traits-title" style="margin-top:20px;">ìƒì„¸ ë¶„ì„ ê·¸ë˜í”„</div>
                <div class="score-visualization" id="imgScoreVisualization">
                    <!-- ë™ì¼í•œ ë°” ê·¸ë˜í”„ê°€ ë Œë”ë§ë¨ -->
                </div>
            </div>
            <div class="result-card-footer">
                <div class="footer-title">SCTI Â· Sungrak Church Type Indicator</div>
                ê²°ê³¼ ì´ë¯¸ì§€ëŠ” êµì œ ë° íŒ€ë¹Œë”©ì„ ìœ„í•´ì„œë§Œ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.
            </div>
        </div>

        <!-- ë¡œë”© -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <div style="margin-top:10px;color:var(--text-dark);font-weight:600;">ì´ë¯¸ì§€ ìƒì„± ì¤‘â€¦</div>
        </div>
    </div>

<script>
/* =======================
   ì§ˆë¬¸ 20ë¬¸í•­ (ê° 5ë¬¸í•­ Ã— 4ì¹´í…Œê³ ë¦¬)
   ======================= */
const questionsBase = [
    // ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥ (R/S)
    {
        category: 'ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥',
        text: 'ğŸµ ì„±ê°€ëŒ€ ì—°ìŠµì— 10ë¶„ ëŠ¦ì€ ë‹¹ì‹ ! ëª¨ë‘ê°€ ë¨¼ì € ì™€ ìˆê³ , ë‹¹ì‹ ë§Œ ëˆˆì¹˜ ë³´ë©° ë“¤ì–´ê°„ ìƒí™©ì—ì„œâ€¦',
        leftText: 'ê°€ë³ê²Œ ì‚¬ê³¼í•˜ê³  ì£¼ë³€ì— ìì—°ìŠ¤ëŸ½ê²Œ ì„ì´ëŠ” í¸ì´ë‹¤.',
        rightText: 'ëˆ„êµ¬ë„ ë§ ì•ˆ ê±¸ì—ˆìœ¼ë©´ í•˜ê³  ê·¸ëƒ¥ ë¬µë¬µíˆ ì•‰ì•„ìˆëŠ” í¸ì´ë‹¤.',
        leftType: 'R',
        rightType: 'S'
    },
    {
        category: 'ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥',
        text: 'ğŸ™‹ ì²­ë…„ë¶€ì— ìƒˆë¡œ ì˜¨ ì§€ì²´ê°€ í˜¼ì ì•‰ì•„ìˆë‹¤.',
        leftText: 'ë°˜ê°€ìš´ ë§ˆìŒìœ¼ë¡œ ë¨¼ì € ë‹¤ê°€ê°€ ë§ì„ ê±´ë„¨ë‹¤.',
        rightText: 'ì–´ìƒ‰í•´ì„œ ë‹¤ê°€ê°€ê¸´ ì–´ë µì§€ë§Œ ì¡°ìš©íˆ ê´€ì‹¬ì„ ê°–ê³  ê¸°íšŒê°€ ë˜ë©´ ê°œì¸ì ìœ¼ë¡œ ëŒ€í™”í•œë‹¤.',
        leftType: 'R',
        rightType: 'S'
    },
    {
        category: 'ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥',
        text: 'ğŸ“† ìˆ˜ë ¨íšŒì— ì°¸ì„í•˜ê²Œ ëœ ë‹¹ì‹ , ê°€ì¥ ê¸°ëŒ€í•˜ëŠ” ê²ƒì€?',
        leftText: 'ë§ì€ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ëœ¨ê±°ìš´ ì˜ˆë°°ë¥¼ ë“œë¦¬ëŠ” ê²ƒ',
        rightText: 'í˜¼ìë§Œì˜ ì‹œê°„ì— ëœ¨ê²ê²Œ ê¸°ë„í•˜ëŠ” ê²ƒ',
        leftType: 'R',
        rightType: 'S'
    },
    {
        category: 'ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥',
        text: 'ğŸ§  ì‹ ì•™ì ì¸ ê³ ë¯¼ì´ ê¹Šì–´ì§„ ì‹œê¸°, ë‹¹ì‹ ì€?',
        leftText: 'ì‹ ì•™ ì¹œêµ¬ë“¤ê³¼ ë‚˜ëˆ„ë©° í•¨ê»˜ ê¸°ë„í•œë‹¤.',
        rightText: 'í˜¼ì í•˜ë‚˜ë‹˜ê»˜ ê¸°ë„í•˜ë©° ë‹µì„ êµ¬í•œë‹¤.',
        leftType: 'R',
        rightType: 'S'
    },
    {
        category: 'ê³µë™ì²´ ì°¸ì—¬ ì„±í–¥',
        text: 'â“ êµíšŒ ì¬ì •ì´ë‚˜ í—Œê¸ˆì— ëŒ€í•´ ë‚´ ë§ˆìŒì€?',
        leftText: 'ê³µë™ì²´ê°€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë¼ ê¸°êº¼ì´ ë‚˜ëˆ„ê³  ì‹¶ì€ ë§ˆìŒì´ë‹¤.',
        rightText: 'ì¡°ìš©íˆ í•˜ë‚˜ë‹˜ ì•ì—ì„œ ê²°ì •í•˜ê³  í—Œê¸ˆì€ ê°œì¸ì ì¸ í—Œì‹ ì´ë¼ê³  ìƒê°í•œë‹¤.',
        leftType: 'R',
        rightType: 'S'
    },

    // ì‹ ì•™ í‘œí˜„ë°©ì‹ (E/W)
    {
        category: 'ì‹ ì•™ í‘œí˜„ë°©ì‹',
        text: 'ğŸ¤ ì¸ì›Œì‹­ì— ì°¸ì„í•œ ë‹¹ì‹ , ì–´ë–¤ ìŠ¤íƒ€ì¼ì¸ê°€ìš”?',
        leftText: 'ëª¸ìœ¼ë¡œ í‘œí˜„í•˜ë©° ê°ì •ì´ ìš°ëŸ¬ë‚˜ëŠ” ì°¬ì–‘ì„ ì¢‹ì•„í•œë‹¤',
        rightText: 'ê°€ì‚¬ì˜ ì˜ë¯¸ë¥¼ ìƒê°í•˜ë©° ì¡°ìš©íˆ ë§ˆìŒìœ¼ë¡œ ë¶€ë¥¸ë‹¤',
        leftType: 'E',
        rightType: 'W'
    },
    {
        category: 'ì‹ ì•™ í‘œí˜„ë°©ì‹',
        text: 'ğŸ“– ë§ì”€ ë“£ëŠ” ì¤‘, ë‹¹ì‹ ì˜ ìì„¸ëŠ”?',
        leftText: 'ë§ì”€ì„ í†µí•´ ë°›ì€ ê°ë™ê³¼ ëŠë‚Œì„ ì¤‘ì‹¬ìœ¼ë¡œ ì •ë¦¬í•œë‹¤.',
        rightText: 'ë…¼ë¦¬ì  íë¦„ê³¼ ë‹¨ì–´ì˜ ëœ»ì„ êµ¬ì¡°ì ìœ¼ë¡œ ì •ë¦¬í•œë‹¤.',
        leftType: 'E',
        rightType: 'W'
    },
    {
        category: 'ì‹ ì•™ í‘œí˜„ë°©ì‹',
        text: 'ğŸ™ ê¸°ë„ì‘ë‹µì„ ê²½í—˜í–ˆì„ ë•Œ',
        leftText: 'í•˜ë‚˜ë‹˜ì´ ì‚´ì•„ê³„ì‹¬ì„ ëŠê¼ˆë‹¤ëŠ” ì²´í—˜ì— ì§‘ì¤‘í•œë‹¤.',
        rightText: 'í•˜ë‚˜ë‹˜ì˜ ëœ»ì´ ë¬´ì—‡ì¸ì§€ ê¹¨ë‹¬ì€ ê²ƒì— ì§‘ì¤‘í•œë‹¤.',
        leftType: 'E',
        rightType: 'W'
    },
    {
        category: 'ì‹ ì•™ í‘œí˜„ë°©ì‹',
        text: 'ğŸ’¬ ìˆ˜ë ¨íšŒ ì´í›„, ëª©ì¥ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ê°„ì¦ ë‚˜ëˆ”ì„ í•˜ê²Œ ëœ ë‹¹ì‹ ',
        leftText: 'í•˜ë‚˜ë‹˜ì„ ê²½í—˜í•œ ìˆœê°„ì˜ ê°ì •ê³¼ ëŠë‚Œì„ ìì„¸íˆ ë‚˜ëˆˆë‹¤',
        rightText: 'í•˜ë‚˜ë‹˜ì´ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ ì—­ì‚¬í•˜ì…¨ëŠ”ì§€ ì‚¬ì‹¤ ì¤‘ì‹¬ìœ¼ë¡œ ë‚˜ëˆˆë‹¤',
        leftType: 'E',
        rightType: 'W'
    },
    {
        category: 'ì‹ ì•™ í‘œí˜„ë°©ì‹',
        text: 'ğŸ’° ì¬ì •ì´ë‚˜ ì‹œê°„ì˜ ìš°ì„ ìˆœìœ„ë¥¼ ì •í•  ë•Œ ê¸°ì¤€ì€?',
        leftText: 'ë§ˆìŒì†ì—ì„œ í•˜ë‚˜ë‹˜ì´ ì£¼ì‹  ê°ë™ì´ë‚˜ íë¦„ì„ ë”°ë¥¸ë‹¤.',
        rightText: 'ë§ì”€ì„ í†µí•´ ë°°ìš°ê³  ì ìš©í•œ ì›ì¹™ì„ ì¤‘ì‹¬ìœ¼ë¡œ íŒë‹¨í•œë‹¤.',
        leftType: 'E',
        rightType: 'W'
    },

    // í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹ (D/P)
    {
        category: 'í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹',
        text: 'ğŸ“– ì„±ê²½ì„ ì½ì„ ë•Œ ê°€ì¥ ë¨¼ì € ë“œëŠ” ê°ì •ì€?',
        leftText: 'í•˜ë‚˜ë‹˜ì´ ë‚´ê²Œ ë§ ê±¸ì–´ ì£¼ì‹œëŠ” ë“¯í•œ ì¹œë°€ê°ì„ ëŠë¼ëŠ” í¸ì´ë‹¤',
        rightText: 'í•˜ë‚˜ë‹˜ì˜ ëª…ë ¹ê³¼ ê¸°ì¤€ì´ ë¬´ì—‡ì¸ì§€ ì°¾ëŠ” í¸ì´ë‹¤',
        leftType: 'D',
        rightType: 'P'
    },
    {
        category: 'í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹',
        text: 'ğŸ™ ê¸°ë„í•  ë•Œ, ë‹¹ì‹ ì€ í•˜ë‚˜ë‹˜ì„ ì–´ë–»ê²Œ ê·¸ë¦¬ëŠ”ê°€?',
        leftText: 'ë‚´ê°€ í˜ë“¤ ë•Œ ì•ˆì•„ ì£¼ì‹œëŠ” ë”°ëœ»í•œ ë¶„',
        rightText: 'ë‚´ ì‚¶ì„ íŒë‹¨í•˜ê³  ì´ë„ì‹œëŠ” ê¸°ì¤€ì´ì ì£¼ê¶Œì',
        leftType: 'D',
        rightType: 'P'
    },
    {
        category: 'í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹',
        text: 'ğŸ§­ ë¯¿ìŒì˜ ê²°ì •ì„ ë‚´ë ¤ì•¼ í•  ë•Œ, ë‹¹ì‹ ì€?',
        leftText: 'ë§ˆìŒì— í‰ì•ˆì´ ìˆëŠ”ì§€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë¶„ë³„í•œë‹¤.',
        rightText: 'ë§ì”€ì˜ ê¸°ì¤€ì— ë§ëŠ”ì§€ë¥¼ ë”°ì ¸ë³¸ë‹¤.',
        leftType: 'D',
        rightType: 'P'
    },
    {
        category: 'í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹',
        text: 'âœï¸ ì‹ ì•™ìƒí™œì˜ ì£¼ëœ ë™ê¸°ëŠ”',
        leftText: 'í•˜ë‚˜ë‹˜ê³¼ì˜ ë” ê¹Šì€ ì‚¬ë‘ì˜ ê´€ê³„ë¥¼ ìœ„í•´',
        rightText: 'í•˜ë‚˜ë‹˜ì´ ê¸°ë»í•˜ì‹œëŠ” ì˜¬ë°”ë¥¸ ì‚¶ì„ ì‚´ê¸° ìœ„í•´',
        leftType: 'D',
        rightType: 'P'
    },
    {
        category: 'í•˜ë‚˜ë‹˜ ì¸ì‹ë°©ì‹',
        text: 'ğŸ™Œ í•˜ë‚˜ë‹˜ê»˜ í—Œì‹ ì„ ê²°ë‹¨í•  ë•Œ, ì–´ë–¤ ë§ˆìŒì´ ì•ì„œëŠ”ê°€?',
        leftText: 'í•˜ë‚˜ë‹˜ê»˜ ì‚¬ë‘ë°›ê³  ìˆë‹¤ëŠ” ê°ê²©ì´ í—Œì‹ ì˜ ì›ë™ë ¥ì´ë‹¤.',
        rightText: 'í•˜ë‚˜ë‹˜ì˜ ëœ»ì— ìˆœì¢…í•˜ëŠ” ê²ƒì´ ë‹¹ì—°í•˜ë‹¤ëŠ” ì±…ì„ê°ì´ ì•ì„ ë‹¤.',
        leftType: 'D',
        rightType: 'P'
    },

    // ì‹ ì•™ìƒí™œ íŒ¨í„´ (O/F)
    {
        category: 'ì‹ ì•™ìƒí™œ íŒ¨í„´',
        text: 'ğŸ“† ìˆ˜ë ¨íšŒ ì „ë‚  ë°¤, ë‹¹ì‹ ì€?',
        leftText: 'ì§, ì¼ì •, ë§ì”€ ë‹¤ ì •ë¦¬í•˜ê³  ê¸°ë„ê¹Œì§€ ë§ˆì¹œ ìƒíƒœë‹¤.',
        rightText: 'ë§ˆìŒ ê°€ëŠ” ëŒ€ë¡œ ë‚´ì¼ ì•„ì¹¨ì— ì§ ì‹¸ë„ ê´œì°®ë‹¤.',
        leftType: 'O',
        rightType: 'F'
    },
    {
        category: 'ì‹ ì•™ìƒí™œ íŒ¨í„´',
        text: 'ğŸ“– ì„±ê²½ ì½ê¸°ë¥¼ ì‹œì‘í•˜ë ¤ëŠ” ë‹¹ì‹ .',
        leftText: 'ê³„íší‘œë¥¼ ì„¸ì›Œ í•˜ë£¨ ë¶„ëŸ‰ì„ ì§€í‚¤ë ¤ê³  ë…¸ë ¥í•˜ëŠ” í¸ì´ë‹¤.',
        rightText: 'ë§ˆìŒì— ëŒë¦¬ëŠ” ë³¸ë¬¸ ìœ„ì£¼ë¡œ ììœ ë¡­ê²Œ ì½ëŠ” í¸ì´ë‹¤.',
        leftType: 'O',
        rightType: 'F'
    },
    {
        category: 'ì‹ ì•™ìƒí™œ íŒ¨í„´',
        text: 'ğŸ“ ê¸°ë„ì œëª©ì„ ê¸°ë¡í•˜ëŠ” ë°©ì‹ì€?',
        leftText: 'ë‚ ì§œë³„ë¡œ ì •ë¦¬ëœ ë…¸íŠ¸ë‚˜ ì•±ì„ ì‚¬ìš©í•˜ëŠ” í¸ì´ë‹¤.',
        rightText: 'ë– ì˜¤ë¥¼ ë•Œ ê°„ë‹¨íˆ ë©”ëª¨í•˜ëŠ” í¸ì´ë‹¤.',
        leftType: 'O',
        rightType: 'F'
    },
    {
        category: 'ì‹ ì•™ìƒí™œ íŒ¨í„´',
        text: 'â›ª ì‹ ì•™ìƒí™œì„ ì‹¤ì²œí•˜ëŠ” ë‚˜ë§Œì˜ ë°©ì‹ì€?',
        leftText: 'ì‹ ì•™ìƒí™œì€ ê³„íšì ìœ¼ë¡œ ì‹¤ì²œí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.',
        rightText: 'ì‹ ì•™ìƒí™œì€ íë¦„ì— ë”°ë¼ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ëŠ” ê²ƒì´ ë” ì˜ë¯¸ ìˆë‹¤ê³  ìƒê°í•œë‹¤.',
        leftType: 'O',
        rightType: 'F'
    },
    {
        category: 'ì‹ ì•™ìƒí™œ íŒ¨í„´',
        text: 'ğŸ í—Œê¸ˆì´ë‚˜ ë´‰ì‚¬ë¥¼ í•  ë•Œì˜ ë‚˜ëŠ”?',
        leftText: 'ë¯¸ë¦¬ ê³„íší•˜ê³  ì •í•´ë‘” ë°©ì‹ëŒ€ë¡œ ì •ê¸°ì ìœ¼ë¡œ ì‹¤ì²œí•œë‹¤.',
        rightText: 'ë§ˆìŒì´ ê°ë™ë˜ì—ˆì„ ë•Œ ìë°œì ìœ¼ë¡œ ë“œë¦¬ê³  ì°¸ì—¬í•˜ëŠ” í¸ì´ë‹¤.',
        leftType: 'O',
        rightType: 'F'
    }
];

/* =======================
   ìœ í˜• ì„¤ëª…(ìƒëµ ì—†ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
   ======================= */
const resultTypes = {
    'REDO': { emoji: 'ğŸ’–', nickname: 'ì‚¬ë‘ ë„˜ì¹˜ëŠ” ê³µë™ì²´ ë¦¬ë”',
        description: 'ë‹¹ì‹ ì€ ê³µë™ì²´ ì†ì—ì„œ ì‚¬ë‘ê³¼ ê°ì •ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ë¥¼ í†µí•´ ì‚¶ì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ í™œë™ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•˜ê³  ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•˜ë©°, ì°¬ì–‘ê³¼ ê¸°ë„ë¥¼ í†µí•´ ê¹Šì€ ê°ë™ì„ ë°›ìŠµë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•˜ë©°, ê·¸ë¶„ê³¼ì˜ ê´€ê³„ì—ì„œ í‰ì•ˆì„ ì°¾ìŠµë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ëŠ” ë° ìˆì–´ ì—´ì •ê³¼ ê°ë™ì´ í° ë™ê¸°ê°€ ë©ë‹ˆë‹¤.'
        ]},
    'REDF': { emoji: 'ğŸŒŠ', nickname: 'ììœ ë¡œìš´ ì‚¬ë‘ì˜ íŒŒë„',
        description: 'ë‹¹ì‹ ì€ ê³µë™ì²´ ì†ì—ì„œ ì‚¬ë‘ì„ ë‚˜ëˆ„ê³  ê°ì •ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ ì†ì—ì„œ ììœ ë¡­ê²Œ í—Œì‹ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ í™œë™ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•˜ê³  ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì—ì„œ ì—ë„ˆì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•˜ë©°, ì°¬ì–‘ê³¼ ê¸°ë„ë¥¼ í†µí•´ ê¹Šì€ ê°ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ ê°ë™ì— ë”°ë¼ ìë°œì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'REPO': { emoji: 'ğŸŒˆ', nickname: 'ê°ê²©ì˜ ë¬´ì§€ê°œ',
        description: 'ë‹¹ì‹ ì€ ê³µë™ì²´ ì•ˆì—ì„œ ê°ì •ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê³„íšì ì¸ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ í™œë™ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'REPF': { emoji: 'ğŸŒ»', nickname: 'ììœ ë¡œìš´ ê°ì„±ì˜ ê½ƒ',
        description: 'ë‹¹ì‹ ì€ ê³µë™ì²´ ì•ˆì—ì„œ ê°ì •ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ìœ ì—°í•˜ê²Œ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ í™œë™ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ ê°ë™ì— ë”°ë¼ ìë°œì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'RWDO': { emoji: 'ğŸ”', nickname: 'íƒêµ¬í•˜ëŠ” ì§€ì‹ì˜ ìƒ˜',
        description: 'ë‹¹ì‹ ì€ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ê³  ì´ì„±ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ë¥¼ í†µí•´ ì‚¶ì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ ì•ˆì—ì„œ ì§€ì ì¸ êµë¥˜ë¥¼ ì¦ê¹ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'RWDF': { emoji: 'ğŸŒ¬ï¸', nickname: 'ê³ ìš”í•œ ì„±ì°°ì˜ ë°”ëŒ',
        description: 'ë‹¹ì‹ ì€ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ê³  ì´ì„±ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ ì†ì—ì„œ ììœ ë¡­ê²Œ í—Œì‹ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ì™€ì˜ ê´€ê³„ë¥¼ ì†Œì¤‘íˆ ì—¬ê¹ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ íë¦„ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'RWPO': { emoji: 'ğŸ’', nickname: 'ì§„ë¦¬ì˜ ë³´ì„',
        description: 'ë‹¹ì‹ ì€ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ê³  ì´ì„±ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê³„íšì ì¸ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ì™€ì˜ ê´€ê³„ë¥¼ ì†Œì¤‘íˆ ì—¬ê¹ë‹ˆë‹¤.',
            'ì´ì„±ì ì´ê³  ë…¼ë¦¬ì ì¸ ë°©ì‹ìœ¼ë¡œ ì‹ ì•™ì„ ì´í•´í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'RWPF': { emoji: 'ğŸŒŒ', nickname: 'ì´ì„±ì ì¸ ììœ ì˜ ìš°ì£¼',
        description: 'ë‹¹ì‹ ì€ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ê³  ì´ì„±ì ìœ¼ë¡œ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ìœ ì—°í•˜ê²Œ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'ê³µë™ì²´ì™€ì˜ ê´€ê³„ë¥¼ ì†Œì¤‘íˆ ì—¬ê¹ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ íë¦„ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SEDO': { emoji: 'ğŸ’¡', nickname: 'ê°ì„±ì ì¸ ì§€í˜œì˜ ë“±ëŒ€',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ê°ì •ì ì¸ ê²½í—˜ì„ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ë¥¼ í†µí•´ ì‚¶ì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SEDF': { emoji: 'ğŸŒ¸', nickname: 'ê³ ìš”í•œ ê°ì„±ì˜ ìƒ˜',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ê°ì„±ì ì¸ ê²½í—˜ì„ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ ì†ì—ì„œ ììœ ë¡­ê²Œ í—Œì‹ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ ê°ë™ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SEPO': { emoji: 'ğŸ”¥', nickname: 'ë‚´ë©´ì˜ ì—´ì •ê°€',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ê°ì •ì ì¸ ê²½í—˜ì„ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê³„íšì ì¸ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SEPF': { emoji: 'ğŸ•Šï¸', nickname: 'ê³ ìš”í•œ ì˜í˜¼ì˜ íƒí—˜ê°€',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ê°ì„±ì ì¸ ê²½í—˜ì„ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ìœ ì—°í•˜ê²Œ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ê°ì„±ì ì´ê³  ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ íë¦„ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SWDO': { emoji: 'ğŸ“š', nickname: 'ë§ì”€ ì¤‘ì‹¬ì˜ ì‹¤ì²œê°€',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ì´ì„±ì ì¸ ì´í•´ë¥¼ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ë¥¼ í†µí•´ ì‚¶ì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SWDF': { emoji: 'ğŸŒ³', nickname: 'ê³ ìš”í•œ ë¯¿ìŒì˜ ë‚˜ë¬´',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ì´ì„±ì ì¸ ì´í•´ë¥¼ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ê³¼ì˜ ì¹œë°€í•œ ê´€ê³„ ì†ì—ì„œ ììœ ë¡­ê²Œ í—Œì‹ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ì‚¬ë‘ì´ ë§ê³  ì¹œë°€í•œ ë¶„ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ íë¦„ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SWPO': { emoji: 'ğŸŒŸ', nickname: 'ë¹›ë‚˜ëŠ” ìˆœì¢…ì˜ ë³„',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ì´ì„±ì ì¸ ì´í•´ë¥¼ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê³„íšì ì¸ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ê³„íšì ì´ê³  ê·œì¹™ì ìœ¼ë¡œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]},
    'SWPF': { emoji: 'â›°ï¸', nickname: 'í”ë“¤ë¦¼ ì—†ëŠ” ì‚°',
        description: 'ë‹¹ì‹ ì€ ê°œì¸ì ì¸ ë¬µìƒê³¼ ì´ì„±ì ì¸ ì´í•´ë¥¼ í†µí•´ ì‹ ì•™ì„ í‘œí˜„í•˜ë©°, í•˜ë‚˜ë‹˜ì„ ì›ì¹™ ì¤‘ì‹¬ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ìœ ì—°í•˜ê²Œ ì‹ ì•™ìƒí™œì„ í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
        traits: [
            'í˜¼ìë§Œì˜ ì‹œê°„ì„ í†µí•´ í•˜ë‚˜ë‹˜ê³¼ ê¹Šì´ êµì œí•©ë‹ˆë‹¤.',
            'ë§ì”€ì˜ ë…¼ë¦¬ì  íë¦„ê³¼ ì˜ë¯¸ë¥¼ ê¹Šì´ íƒêµ¬í•©ë‹ˆë‹¤.',
            'í•˜ë‚˜ë‹˜ì„ ê³µì˜ë¡­ê³  ì§ˆì„œì˜ í•˜ë‚˜ë‹˜ìœ¼ë¡œ ì¸ì‹í•©ë‹ˆë‹¤.',
            'ì‹ ì•™ìƒí™œì„ ë§ˆìŒì˜ íë¦„ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹¤ì²œí•©ë‹ˆë‹¤.'
        ]}
};

/* =======================
   ì „ì—­ ìƒíƒœ
   ======================= */
let questions = []; // ì„ì¸ 20ë¬¸í•­
let currentQuestionIndex = 0;
let userAnswers = Array(20).fill(null);
let netScores = { RS: 0, EW: 0, DP: 0, OF: 0 };
const scoreWeightMap = { 4: +2, 3: +1, 2: -1, 1: -2 };

/* =======================
   ìœ í‹¸: ì¹´í…Œê³ ë¦¬ ì„ê¸°(ì—°ì† ë°©ì§€)
   ======================= */
function buildInterleavedQuestions(base) {
    // ì¹´í…Œê³ ë¦¬ë³„ ë²„í‚· ìƒì„±
    const byCat = {};
    base.forEach(q => {
        byCat[q.category] = byCat[q.category] || [];
        byCat[q.category].push(q);
    });
    // ê° ë²„í‚· ë‚´ë¶€ ì…”í”Œ
    Object.values(byCat).forEach(arr => arr.sort(() => Math.random() - 0.5));
    const cats = Object.keys(byCat).sort(() => Math.random() - 0.5);

    const total = base.length;
    const result = [];
    let lastCat = null;
    while (result.length < total) {
        // ì„ íƒ ê°€ëŠ¥í•œ ì¹´í…Œê³ ë¦¬ í›„ë³´ (ë‚¨ì€ê²Œ ìˆê³ , ì§ì „ê³¼ ë‹¤ë¦„)
        const candidates = cats.filter(c => byCat[c].length > 0 && c !== lastCat);
        let chosenCat;
        if (candidates.length === 0) {
            // ë¶ˆê°€í”¼í•˜ê²Œ ê°™ì€ ì¹´í…Œê³ ë¦¬ í—ˆìš© (ì´ë¡ ìƒ 5Ã—4ë©´ ë°œìƒ ì•ˆ í•¨)
            chosenCat = cats.find(c => byCat[c].length > 0);
        } else {
            chosenCat = candidates[Math.floor(Math.random() * candidates.length)];
        }
        result.push(byCat[chosenCat].shift());
        lastCat = chosenCat;
    }
    return result;
}

/* =======================
   ë Œë”ë§
   ======================= */
function startTest() {
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('testScreen').style.display = 'flex';
    currentQuestionIndex = 0;
    userAnswers = Array(20).fill(null);
    netScores = { RS: 0, EW: 0, DP: 0, OF: 0 };
    questions = buildInterleavedQuestions(questionsBase); // ì„ê¸°
    renderQuestion();
    updateProgress();
    updateNavButtons();
}

function renderQuestion() {
    const q = questions[currentQuestionIndex];
    document.getElementById('questionNumber').textContent = `${currentQuestionIndex + 1}/${questions.length}`;
    document.getElementById('questionText').textContent = q.text;

    const optionsContainer = document.getElementById('optionsContainer');
    optionsContainer.innerHTML = '';

    // ë°ìŠ¤í¬í†±ìš© ì¢Œ/ìš° í…ìŠ¤íŠ¸
    const leftTextWrapper = document.createElement('div');
    leftTextWrapper.classList.add('option-text-wrapper','left-text');
    leftTextWrapper.innerHTML = `<p>${q.leftText}</p>`;
    optionsContainer.appendChild(leftTextWrapper);

    const circleWrapper = document.createElement('div');
    circleWrapper.classList.add('circle-wrapper');

    // 4ê°œì˜ ì›í˜• ë²„íŠ¼ (ì¢Œì¸¡ ê°•/ì•½, ìš°ì¸¡ ì•½/ê°•)
    const optionDetails = [
        { score: 4, type: q.leftType, isLarge: true },
        { score: 3, type: q.leftType, isLarge: false },
        { score: 2, type: q.rightType, isLarge: false },
        { score: 1, type: q.rightType, isLarge: true }
    ];

    optionDetails.forEach((opt, idx) => {
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = `question-${currentQuestionIndex}`;
        input.id = `q${currentQuestionIndex}-opt${idx}`;
        input.style.display = 'none';

        const wrap = document.createElement('label');
        wrap.setAttribute('for', input.id);
        wrap.classList.add('option-circle-container');

        const dot = document.createElement('div');
        dot.classList.add('option-circle', opt.isLarge ? 'large' : 'small');
        wrap.appendChild(dot);

        // í´ë¦­ ì²˜ë¦¬
        wrap.addEventListener('click', () => {
            userAnswers[currentQuestionIndex] = { score: opt.score, type: opt.type };
            // í…ìŠ¤íŠ¸ ì„ íƒ íš¨ê³¼
            leftTextWrapper.classList.remove('selected-left','selected-right');
            rightTextWrapper.classList.remove('selected-left','selected-right');
            if (opt.type === q.leftType) {
                leftTextWrapper.classList.add('selected-left');
            } else {
                rightTextWrapper.classList.add('selected-right');
            }
            updateNavButtons();
        });

        circleWrapper.appendChild(input);
        circleWrapper.appendChild(wrap);
    });
    optionsContainer.appendChild(circleWrapper);

    const rightTextWrapper = document.createElement('div');
    rightTextWrapper.classList.add('option-text-wrapper','right-text');
    rightTextWrapper.innerHTML = `<p>${q.rightText}</p>`;
    optionsContainer.appendChild(rightTextWrapper);

    // ëª¨ë°”ì¼ í…ìŠ¤íŠ¸ í‘œì‹œ
    const mobileTextDisplay = document.getElementById('mobileTextDisplay');
    const mobileLeftText = document.getElementById('mobileLeftText');
    const mobileRightText = document.getElementById('mobileRightText');
    if (window.innerWidth <= 767) {
        mobileTextDisplay.style.display = 'block';
        mobileLeftText.textContent = q.leftText;
        mobileRightText.textContent = q.rightText;
    } else {
        mobileTextDisplay.style.display = 'none';
    }

    // ê¸°ì¡´ ì„ íƒ ë³µì›
    const saved = userAnswers[currentQuestionIndex];
    if (saved) {
        if (saved.type === q.leftType) {
            leftTextWrapper.classList.add('selected-left');
        } else {
            rightTextWrapper.classList.add('selected-right');
        }
    }
}

function updateProgress() {
    const bar = document.getElementById('progressBar');
    const pct = ((currentQuestionIndex) / questions.length) * 100;
    bar.style.width = `${pct}%`;
}

function updateNavButtons() {
    const prev = document.getElementById('prevBtn');
    const next = document.getElementById('nextBtn');
    prev.disabled = currentQuestionIndex === 0;
    if (currentQuestionIndex < questions.length - 1) {
        next.textContent = 'ë‹¤ìŒ';
        next.disabled = userAnswers[currentQuestionIndex] === null;
    } else {
        next.textContent = 'ê²°ê³¼ ë³´ê¸°';
        next.disabled = userAnswers[currentQuestionIndex] === null;
    }
}

function prevQuestion() {
    if (currentQuestionIndex === 0) return;
    currentQuestionIndex--;
    renderQuestion();
    updateProgress();
    updateNavButtons();
}

function nextQuestion() {
    if (userAnswers[currentQuestionIndex] === null) return;
    if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
        updateProgress();
        updateNavButtons();
    } else {
        // ì±„ì  ë° ê²°ê³¼ ë Œë”
        calculateScores();
        renderResult();
    }
}

/* =======================
   ì±„ì /ìœ í˜• ê³„ì‚°
   ======================= */
function calculateScores() {
    netScores = { RS: 0, EW: 0, DP: 0, OF: 0 };
    questions.forEach((q, idx) => {
        const ans = userAnswers[idx];
        if (!ans) return;
        const w = scoreWeightMap[ans.score]; // +2,+1,-1,-2
        const t = ans.type;
        if (t === 'R') netScores.RS += w;
        if (t === 'S') netScores.RS -= w; // ìš°ì¸¡ ì„ íƒì€ scoreê°€ 1/2 â†’ wëŠ” ìŒìˆ˜ë¼ ì´ ì²˜ë¦¬ë¡œ ë¶€í˜¸ ë°˜ì „ë¨ ë°©ì§€ ìœ„í•´ ë³„ë„ ë¶„ê¸°
        if (t === 'E') netScores.EW += w;
        if (t === 'W') netScores.EW -= w;
        if (t === 'D') netScores.DP += w;
        if (t === 'P') netScores.DP -= w;
        if (t === 'O') netScores.OF += w;
        if (t === 'F') netScores.OF -= w;
    });
    // ìœ„ì—ì„œ S/W/P/Fì— ëŒ€í•´ -wê°€ ì•„ë‹ˆë¼ ë³„ë„ ì²˜ë¦¬: í˜„ì¬ ë¡œì§ì€
    // ì¢Œì¸¡ ì„ íƒ(+), ìš°ì¸¡ ì„ íƒ(-) ì´ë¯¸ wê°€ ë¶€í˜¸ í¬í•¨ì´ë¼ ë‹¨ìˆœíˆ
    // íƒ€ì…ë³„ +/âˆ’ ì²˜ë¦¬ë¥¼ ë§ì¶° ì¤Œ
    // R/E/D/O ì—ì„œ += w, S/W/P/F ì—ì„œ -= w ë§Œ ìˆ˜í–‰í•˜ë©´ ë¨.
}

/* =======================
   ê²°ê³¼ ë Œë”ë§
   ======================= */
function renderScoreBars(containerId, scores) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';

    const pairs = [
        { key: 'RS', left: 'R', right: 'S' },
        { key: 'EW', left: 'E', right: 'W' },
        { key: 'DP', left: 'D', right: 'P' },
        { key: 'OF', left: 'O', right: 'F' }
    ];

    // í•œ ì¶•ë‹¹ ìµœëŒ€ ì ˆëŒ€ê°’: ì§ˆë¬¸ 5ê°œ Ã— ìµœëŒ€ ê°€ì¤‘ì¹˜ 2 = 10
    const maxAbs = 10;

    pairs.forEach(p => {
        const val = Math.max(-maxAbs, Math.min(maxAbs, scores[p.key]));
        const leftWidth = val > 0 ? (Math.abs(val) / maxAbs) * 50 : 0;   // 0~50%
        const rightWidth = val < 0 ? (Math.abs(val) / maxAbs) * 50 : 0;  // 0~50%

        const row = document.createElement('div');
        row.classList.add('score-row');

        const labels = document.createElement('div');
        labels.classList.add('score-labels');
        const l = document.createElement('div'); l.classList.add('score-label'); l.textContent = p.left;
        const r = document.createElement('div'); r.classList.add('score-label'); r.textContent = p.right;
        if (val > 0) l.classList.add('active');
        if (val < 0) r.classList.add('active');

        labels.appendChild(l);
        labels.appendChild(r);

        const bar = document.createElement('div');
        bar.classList.add('score-bar-container');

        const center = document.createElement('div'); center.classList.add('score-bar-center');
        const fillLeft = document.createElement('div'); fillLeft.classList.add('score-fill-left'); fillLeft.style.width = `${leftWidth}%`;
        const fillRight = document.createElement('div'); fillRight.classList.add('score-fill-right'); fillRight.style.width = `${rightWidth}%`;

        bar.appendChild(center);
        bar.appendChild(fillLeft);
        bar.appendChild(fillRight);

        row.appendChild(labels);
        row.appendChild(bar);
        container.appendChild(row);
    });
}

function renderResult() {
    // ìœ í˜• ì½”ë“œ ê²°ì •
    const typeLetters = [
        netScores.RS >= 0 ? 'R' : 'S',
        netScores.EW >= 0 ? 'E' : 'W',
        netScores.DP >= 0 ? 'D' : 'P',
        netScores.OF >= 0 ? 'O' : 'F'
    ];
    const typeCode = typeLetters.join('');

    const info = resultTypes[typeCode] || {
        emoji: 'âœ¨',
        nickname: 'ê· í˜•í˜•',
        description: 'ë„¤ ì¶•ì´ ë¹„êµì  ê· í˜•ì„ ì´ë£¨ëŠ” í¸ì…ë‹ˆë‹¤.',
        traits: ['ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•©ë‹ˆë‹¤.','ê³µë™ì²´ì™€ ê°œì¸ ì‹œê°„ì„ ê³ ë¥´ê²Œ ì„ í˜¸í•©ë‹ˆë‹¤.']
    };

    // ê²°ê³¼ í™”ë©´ í‘œì‹œ
    document.getElementById('testScreen').style.display = 'none';
    document.getElementById('resultScreen').style.display = 'block';

    document.getElementById('resultTypeCode').textContent = typeCode;
    document.getElementById('resultEmoji').textContent = info.emoji;
    document.getElementById('resultNickname').textContent = info.nickname;
    document.getElementById('resultDescription').textContent = info.description;

    const traitsUl = document.getElementById('resultTraits');
    traitsUl.innerHTML = '';
    info.traits.forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        traitsUl.appendChild(li);
    });

    renderScoreBars('scoreVisualization', netScores);

    // ì´ë¯¸ì§€ ì¹´ë“œìš© ë°ì´í„°ë„ ì±„ìš°ê¸° (ê·¸ë˜í”„ í¬í•¨)
    document.getElementById('imgTypeCode').textContent = typeCode;
    document.getElementById('imgEmoji').textContent = info.emoji;
    document.getElementById('imgNickname').textContent = info.nickname;
    document.getElementById('imgDescription').textContent = info.description;

    const imgTraits = document.getElementById('imgTraits');
    imgTraits.innerHTML = '';
    info.traits.forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        imgTraits.appendChild(li);
    });
    renderScoreBars('imgScoreVisualization', netScores);
}

/* =======================
   ì´ë¯¸ì§€ ì €ì¥ (ê·¸ë˜í”„ í¬í•¨)
   ======================= */
async function saveResultImage() {
    const card = document.getElementById('resultCardForImage');
    const loading = document.getElementById('loading');
    try {
        loading.style.display = 'block';
        card.style.display = 'block'; // í™”ë©´ì— í‘œì‹œí•´ì•¼ ìº¡ì²˜ë¨
        window.scrollTo(0, 0);

        // ì•½ê°„ì˜ ë Œë” ì•ˆì •í™” ëŒ€ê¸°
        await new Promise(res => setTimeout(res, 150));

        const canvas = await html2canvas(card, {
            backgroundColor: '#ffffff',
            useCORS: true,
            scale: 2,
            windowWidth: card.scrollWidth,
            windowHeight: card.scrollHeight
        });

        const link = document.createElement('a');
        const now = new Date();
        const y = now.getFullYear();
        const m = String(now.getMonth()+1).padStart(2,'0');
        const d = String(now.getDate()).padStart(2,'0');
        link.download = `SCTI_${y}${m}${d}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
    } catch (e) {
        alert('ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
        console.error(e);
    } finally {
        document.getElementById('resultCardForImage').style.display = 'none';
        loading.style.display = 'none';
    }
}

/* =======================
   ì‹œì‘ ë²„íŠ¼ ë°”ì¸ë”© (ì•ˆì „)
   ======================= */
window.startTest = startTest;
window.prevQuestion = prevQuestion;
window.nextQuestion = nextQuestion;
window.saveResultImage = saveResultImage;
</script>
</body>
</html>
